import{c as J,d as X,h as w,o as f,i as b,w as s,j as a,u as e,m as c,n as U,k as r,v as y,a7 as M,N as L,a as q,q as H,a4 as ae,F as ee,a3 as ie,A as De,e as $e,L as R,f as $,B as qe,C as Ve,D as He,E as z,G as Fe,H as Ie,I as je,J as ne,s as ke,K as ze,M as Ae,O as le,P as oe,b as Y,Q as ue,R as re,S as de,T as me,U as ce,V as fe,W as pe,p as G,ah as Ee,a0 as g,a6 as te,ai as Te,aj as Ne,ak as Be,ac as Ue,ad as se,a9 as _e,aa as ge}from"./app-_lgDiFIF.js";import{E as Re,_ as Me,S as Le,u as Oe,v as We,w as Ke,x as Ge,y as Je,z as Xe,A as Qe,B as Ye,a as Ze,b as ea,c as aa,r as ye,X as he,d as ve,e as ta,f as sa,g as xe,h as na,i as la,j as oa,k as ia,l as ua,m as ra}from"./FilterBarPresentation.vue_vue_type_script_setup_true_lang-CFMY4aMz.js";import{e as O,F as A,_ as E,a as T,b as N,d as B,c as Z,u as da}from"./Input.vue_vue_type_script_setup_true_lang-CJBlVlO3.js";import{_ as ma,a as ca,b as fa,c as pa,d as _a,e as ga}from"./DrawerTitle.vue_vue_type_script_setup_true_lang-CPvPlu3Q.js";import{E as ya}from"./eye-sj_jIObT.js";import{P as ha,M as va}from"./phone-outgoing-BpxXoVJL.js";import{u as xa,_ as Pa,a as ba,b as wa,c as $a,d as ka,e as Sa}from"./Textarea.vue_vue_type_script_setup_true_lang-D-OTkt1Q.js";import{_ as Pe,a as be,b as we}from"./PopoverTrigger.vue_vue_type_script_setup_true_lang-duuPVoGo.js";import{u as Ca}from"./useFetchHousingRoom-B3RrqMGu.js";/**
 * @license lucide-vue-next v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Da=J("BanIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-vue-next v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Se=J("CircleCheckBigIcon",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-vue-next v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qa=J("CircleSlashIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"9",x2:"15",y1:"15",y2:"9",key:"1dfufj"}]]);/**
 * @license lucide-vue-next v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=J("CircleXIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-vue-next v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Va=J("FilePlus2Icon",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M3 15h6",key:"4e2qda"}],["path",{d:"M6 12v6",key:"1u72j0"}]]),Ha={class:"grid lg:grid-cols-[auto_1fr_auto] gap-3"},Fa={class:"bg-white dark:bg-slate-300 shadow-lg rounded-lg p-4 max-w-xl w-full mx-auto lg:order-2"},Ia={class:"flex justify-between"},ja={class:"text-gray-700"},za={class:"flex justify-between"},Aa={class:"font-medium"},Ea={class:"text-gray-700"},Ta={class:"flex justify-between"},Na={class:"text-gray-700"},Ba={class:"flex justify-between"},Ua={class:"font-medium"},Ra={class:"text-gray-700"},Ma={class:"text-gray-700 font-semibold text-center my-4"},La={class:"flex justify-between"},Oa={class:"text-gray-700 font-bold"},Wa={class:"flex justify-between font-bold"},Ka={key:0,class:"flex items-center gap-1 text-green-700"},Ga={key:1,class:"flex items-center gap-1 text-blue-700"},Ja={key:0,class:"text-black whitespace-pre-wrap font-medium mt-5 text-justify"},Xa={class:"mx-auto w-full sm:w-[50vw] lg:w-[25vw] lg:order-1"},Qa=["src"],Ya={key:1,class:"animate-pulse"},Za={class:"mx-auto w-full sm:w-[50vw] lg:w-[25vw] lg:order-3"},et=["src"],at={key:1,class:"animate-pulse"},tt=["src"],st=X({__name:"HousingPaymentDetail",props:{isDrawerOpen:{type:Boolean},housingPayment:{}},emits:["update:drawer-state"],setup(S,{emit:v}){const m=v;function h(d){m("update:drawer-state",d)}const x=window.innerWidth>1023&&window.innerWidth<1290?270:350,l=w(null),P=w("");function p(d,n){P.value=n,document.startViewTransition?document.startViewTransition(()=>{l.value=d}):l.value=d}function F(){document.startViewTransition?document.startViewTransition(()=>{l.value=null,P.value=""}):(l.value=null,P.value="")}return(d,n)=>(f(),b(e(ga),{open:d.isDrawerOpen,"onUpdate:open":n[2]||(n[2]=k=>h(k))},{default:s(()=>[a(e(ma),null,{default:s(()=>[c("div",{class:U(`p-4 overflow-y-auto ${l.value?"h-[97vh]":"max-h-[80vh] sm:max-h-[90vh]"}`)},[a(e(ca),{class:"max-w-lg mx-auto"},{default:s(()=>[a(e(fa),{class:"text-xl font-semibold dark:text-slate-200"},{default:s(()=>n[3]||(n[3]=[r("Detalles del alquiler")])),_:1}),a(e(pa),{class:"text-gray-500"},{default:s(()=>n[4]||(n[4]=[r(" Aquí puedes ver los detalles de este alquiler. ")])),_:1})]),_:1}),c("main",Ha,[c("section",Fa,[n[10]||(n[10]=c("h3",{class:"text-lg font-bold"},"Información del alquiler",-1)),c("div",Ia,[n[5]||(n[5]=c("span",{class:"font-medium"},"Nombre del inquilino:",-1)),c("span",ja,y(d.housingPayment.tenancy_name),1)]),c("div",za,[c("span",Aa,y(d.housingPayment.tenancy_identity_document)+":",1),c("span",Ea,y(d.housingPayment.tenancy_document_number),1)]),c("div",Ta,[n[6]||(n[6]=c("span",{class:"font-medium"},"Teléfono:",-1)),c("span",Na,y(d.housingPayment.tenancy_phone),1)]),c("div",Ba,[c("span",Ua,y(d.housingPayment.housing),1),c("span",Ra,"Habitación "+y(d.housingPayment.housing_room),1)]),c("p",Ma," Desde "+y(e(M)(d.housingPayment.rental_start_date))+" hasta "+y(e(M)(d.housingPayment.rental_end_date)),1),c("div",La,[n[7]||(n[7]=c("span",{class:"font-medium"},"Pago:",-1)),c("span",Oa,y(d.housingPayment.payment.toLocaleString(e(L).lang,{style:"currency",currency:"PEN"})),1)]),c("div",Wa,[n[9]||(n[9]=c("span",{class:"font-medium"},"Estado:",-1)),d.housingPayment.payment_date?(f(),q("div",Ka,[a(e(Se),{size:33}),r(" "+y(e(M)(d.housingPayment.payment_date)),1)])):H("",!0),d.housingPayment.payment_date?H("",!0):(f(),q("div",Ga,[a(e(Ce),{size:33}),n[8]||(n[8]=r(" Pendiente "))]))]),d.housingPayment.description?(f(),q("p",Ja,y(d.housingPayment.description),1)):H("",!0)]),c("picture",Xa,[d.housingPayment.first_document_image_url?(f(),q("img",{key:0,src:d.housingPayment.first_document_image_url,alt:"documento",class:"rounded-lg mx-auto",style:ae({viewTransitionName:l.value?"":"img-1"}),onClick:n[0]||(n[0]=ee(k=>p(d.housingPayment.first_document_image_url,"img-1"),["stop"]))},null,12,Qa)):(f(),q("section",Ya,[a(e(ie),{class:"mx-auto text-slate-500",size:e(x)},null,8,["size"])]))]),c("picture",Za,[d.housingPayment.second_document_image_url?(f(),q("img",{key:0,src:d.housingPayment.second_document_image_url,alt:"documento",class:"rounded-lg mx-auto",style:ae({viewTransitionName:l.value?"":"img-2"}),onClick:n[1]||(n[1]=ee(k=>p(d.housingPayment.second_document_image_url,"img-2"),["stop"]))},null,12,et)):(f(),q("section",at,[a(e(ie),{class:"mx-auto text-slate-500",size:e(x)},null,8,["size"])]))])]),a(e(_a),{class:"mt-4"},{default:s(()=>[a(e(De),{"as-child":""},{default:s(()=>[a(O,{variant:"outline",class:"max-w-lg w-full mx-auto dark:text-slate-200"},{default:s(()=>n[11]||(n[11]=[r(" Cerrar ")])),_:1})]),_:1})]),_:1})],2),l.value?(f(),q("picture",{key:0,class:"fixed top-0 left-0 w-screen h-screen flex items-center justify-center backdrop-blur-md z-50",onClick:ee(F,["stop"])},[c("img",{src:l.value,class:"max-h-[98vh] rounded-2xl mx-auto",alt:"documento",style:ae({viewTransitionName:P.value})},null,12,tt)])):H("",!0)]),_:1})]),_:1},8,["open"]))}});function nt(S){return $e(L.housing_payment,S)}const lt={class:"font-bold text-slate-300"},ot=X({__name:"DropdownHousingPaymentOptions",props:{housingPayment:{}},emits:["update:housing-payment-form"],setup(S,{emit:v}){const m=S,h=v;function x(){h("update:housing-payment-form",m.housingPayment)}const l=w(!1),P=w(!1),p=w(1),F=()=>{l.value=!0},d=_=>{l.value=_},n=_=>{P.value=!0,p.value=_},k=_=>{P.value=_},V=R(()=>({url:`${$.housing_payment}/${p.value===1?$.collect_and_payment:p.value===2?$.just_collect:$.cancel_collect}`,method:$.post})),{mutateAsync:W}=nt(V),j=R(()=>({id:m.housingPayment.id,housing_room_id:m.housingPayment.housing_room_id,tenancy_id:m.housingPayment.tenancy_id,payment:m.housingPayment.payment,rental_start_date:m.housingPayment.rental_start_date,rental_end_date:m.housingPayment.rental_end_date,description:m.housingPayment.description})),C=()=>ke(W(j.value),`${p.value===1?"Cobrando y agregando nuevo alquiler":p.value===2?"Cobrando":"Cancelando"}...`,()=>`Alquiler ${p.value===1?"cobrado y uno nuevo creado":p.value===2?"cobrado":"cancelado"} con éxito para ${m.housingPayment.tenancy_name}`,_=>typeof _=="object"?"Acción fallida":_);return(_,u)=>(f(),q(ne,null,[a(e(je),null,{default:s(()=>[a(e(qe),{"as-child":""},{default:s(()=>[a(e(O),{variant:"ghost",class:"w-8 h-8 p-0"},{default:s(()=>[u[4]||(u[4]=c("span",{class:"sr-only"},"Abrir menu",-1)),a(e(Re),{class:"w-4 h-4"})]),_:1})]),_:1}),a(e(Ve),{align:"end"},{default:s(()=>[a(e(He),null,{default:s(()=>u[5]||(u[5]=[r("Opciones")])),_:1}),_.housingPayment.payment_date?H("",!0):(f(),b(e(z),{key:0,class:"flex items-center gap-x-2 text-amber-700 dark:text-amber-500 py-2 cursor-pointer",onClick:u[0]||(u[0]=I=>n(1))},{default:s(()=>[a(e(Va),{class:"w-5 h-5"}),u[6]||(u[6]=r(" Cobrar y agregar alquiler "))]),_:1})),_.housingPayment.payment_date?H("",!0):(f(),b(e(z),{key:1,class:"flex items-center gap-x-2 text-yellow-700 dark:text-yellow-500 py-2 cursor-pointer",onClick:u[1]||(u[1]=I=>n(2))},{default:s(()=>[a(e(qa),{class:"w-5 h-5"}),u[7]||(u[7]=r(" Solo cobrar "))]),_:1})),_.housingPayment.payment_date?(f(),b(e(z),{key:2,class:"flex items-center gap-x-2 text-rose-700 dark:text-rose-500 py-2 cursor-pointer",onClick:u[2]||(u[2]=I=>n(3))},{default:s(()=>[a(e(Da),{class:"w-5 h-5"}),u[8]||(u[8]=r(" Cancelar cobro "))]),_:1})):H("",!0),a(e(z),{onClick:ee(F,["stop"]),class:"flex items-center gap-x-2 py-2 cursor-pointer"},{default:s(()=>[a(e(ya),{class:"w-5 h-5"}),u[9]||(u[9]=r(" Ver "))]),_:1}),a(Me,{class:"w-full"},{default:s(()=>[a(e(z),{onClick:x,class:"flex items-center gap-x-2 text-sky-700 dark:text-sky-500 py-2 cursor-pointer"},{default:s(()=>[a(e(Le),{class:"w-5 h-5"}),u[10]||(u[10]=r(" Editar "))]),_:1})]),_:1}),a(e(z),{as:"a",class:"flex items-center gap-x-2 text-red-700 dark:text-red-500 py-2 cursor-pointer",href:e(Fe)(_.housingPayment.tenancy_phone)},{default:s(()=>[a(e(ha),{class:"w-5 h-5"}),u[11]||(u[11]=r(" Llamar "))]),_:1},8,["href"]),a(e(z),{as:"a",class:"flex items-center gap-x-2 text-green-700 dark:text-green-500 py-2 cursor-pointer",href:e(Ie)(_.housingPayment.tenancy_phone,"?text=Buen%20día"),target:"_blank"},{default:s(()=>[a(e(va),{class:"w-5 h-5"}),u[12]||(u[12]=r(" Whatsapp "))]),_:1},8,["href"])]),_:1})]),_:1}),a(st,{"is-drawer-open":l.value,"housing-payment":_.housingPayment,"onUpdate:drawerState":d},null,8,["is-drawer-open","housing-payment"]),a(e(Ye),{open:P.value,"onUpdate:open":u[3]||(u[3]=I=>k(I))},{default:s(()=>[a(e(Oe),null,{default:s(()=>[a(e(We),null,{default:s(()=>[a(e(Ke),{class:"dark:text-slate-200"},{default:s(()=>[r(y(`¿Estás seguro que quieres ${p.value===1?"cobrar y agregar un nuevo alquiler":p.value===2?"solo cobrar el alquiler":"cancelar este cobro de alquiler"}`),1)]),_:1}),a(e(Ge),null,{default:s(()=>[r(y(`Esta accion ${p.value===1?"cobrará y agregará un nuevo alquiler para":p.value===2?"solo cobrará el alquiler de":"cancelará este cobro de alquiler de"}`)+" ",1),c("span",lt,y(_.housingPayment.tenancy_name)+" - "+y(_.housingPayment.tenancy_identity_document)+": "+y(_.housingPayment.tenancy_document_number),1)]),_:1})]),_:1}),a(e(Je),null,{default:s(()=>[a(e(Xe),{class:"dark:text-slate-200"},{default:s(()=>u[13]||(u[13]=[r("Cancelar")])),_:1}),a(e(Qe),{onClick:C},{default:s(()=>u[14]||(u[14]=[r("Sí, ¡seguro!")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"])],64))}});function it(S,v){const m=()=>Ae(`${$.housing_payment}/${$.list_action}?page=${v.page}&limit=${v.limit}&searchInput=${v.searchParam}&startDate=${v.startDate}&finishDate=${v.finishDate}${v.paymentState==="rent_debtors"?"&rent_debtors=1":v.paymentState==="rent_payers"?"&rent_payers=1":""}`),{data:h,...x}=ze(S,m,v),l=R(()=>{var p;return((p=h.value)==null?void 0:p.data)??[]}),P=R(()=>{var p;return((p=h.value)==null?void 0:p.meta)??null});return{data:l,meta:P,...x}}function ut(S){return $e(L.housing_payment,S)}const rt={class:"flex flex-col sm:grid grid-cols-2 gap-x-2 gap-y-1 overflow-y-auto max-h-[71vh] p-1"},dt=X({__name:"HousingPaymentModal",props:{form:{}},emits:["reset"],setup(S,{emit:v}){const m=S,h=v,x=R(()=>!!m.form.values.id),l=R(()=>({url:`${$.housing_payment}/${x.value?$.update_action:$.store_action}`,method:x.value?$.put:$.post})),{isPending:P,mutateAsync:p}=ut(l),F=m.form.handleSubmit(D=>ke(p(D),`${x.value?"Editando":"Agregando"}...`,()=>(K(),`Alquiler ${x.value?"actualizado":"agregado"} con éxito`),t=>typeof t=="object"?(m.form.setErrors(t),"Acción fallida"):t)),d=w(!1),n=w(""),k=w(1),V=le({page:1,limit:20,searchParam:"",startDate:"",finishDate:""}),{data:W}=xa("",V),j=w(!1),C=w(""),_=w(1),u=le({page:1,limit:20,searchParam:"",active:1}),{data:I}=Ca("",u);function K(){h("reset"),Q(!1)}function Q(D){D?(V.searchParam=m.form.values.tenancy_name,n.value=m.form.values.tenancy_name,u.searchParam=m.form.values.housing_room,C.value=`${m.form.values.housing_room} - ${m.form.values.housing}`):(V.searchParam="",n.value="",u.searchParam="",C.value="",k.value++,_.value++)}return oe(x,D=>{Q(D)}),(D,t)=>(f(),b(e(sa),{class:"sm:max-w-[600px] text-slate-800 dark:dark:text-slate-200"},{default:s(()=>[a(e(Ze),null,{default:s(()=>[a(e(ea),null,{default:s(()=>[r(y(x.value?"Editar":"Agregar")+" alquiler",1)]),_:1}),a(e(aa),null,{default:s(()=>[r(" Haz los cambios del alquiler aquí. Click "+y(x.value?"Editar":"Agregar")+" cuando termines. ",1)]),_:1})]),_:1}),c("form",{onSubmit:t[8]||(t[8]=(...i)=>e(F)&&e(F)(...i)),"keep-values":""},[c("section",rt,[a(e(A),{name:"tenancy_id"},{default:s(({componentField:i})=>[a(e(E),null,{default:s(()=>[a(e(T),null,{default:s(()=>t[9]||(t[9]=[r("Inquilino")])),_:1}),a(e(Pe),{open:d.value,"onUpdate:open":t[3]||(t[3]=o=>d.value=o)},{default:s(()=>[a(e(be),{"as-child":""},{default:s(()=>[a(e(N),null,{default:s(()=>[a(e(O),{type:"button",variant:"outline",role:"combobox",class:U(e(Y)("w-full sm:w-64 justify-between",!i.modelValue&&"text-muted-foreground"))},{default:s(()=>[r(y(n.value||"Selecciona al inquilino...")+" ",1),a(e(ye),{class:"ml-2 h-4 w-4 shrink-0 opacity-50"})]),_:2},1032,["class"])]),_:2},1024)]),_:2},1024),a(e(we),{class:"w-[370px] sm:w-64 p-0"},{default:s(()=>[(f(),b(e(ue),{key:k.value,modelValue:n.value,"onUpdate:modelValue":t[2]||(t[2]=o=>n.value=o),class:"p-0"},{default:s(()=>[a(e(re),{class:"w-full px-4 py-2",placeholder:"Busca al inquilino...",onInput:t[0]||(t[0]=o=>V.searchParam=o.target.value)}),n.value.length>0||V.searchParam.length>0?(f(),b(e(he),{key:0,class:"absolute right-5 top-3",size:20,onClick:t[1]||(t[1]=()=>{V.searchParam="",n.value="",k.value++})})):H("",!0),a(e(de),null,{default:s(()=>t[10]||(t[10]=[r("Sin resultados.")])),_:1}),a(e(me),null,{default:s(()=>[a(e(ce),null,{default:s(()=>[(f(!0),q(ne,null,fe(e(W),o=>(f(),b(e(pe),{key:o.id,value:o.name,onSelect:()=>{m.form.setFieldValue("tenancy_id",o.id),n.value=o.name,d.value=!1}},{default:s(()=>[r(y(o.name)+" ",1),a(e(ve),{class:U(e(Y)("ml-auto h-4 w-4",m.form.values.tenancy_id==o.id?"opacity-100":"opacity-0"))},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"]))]),_:1})]),_:2},1032,["open"]),a(e(B))]),_:2},1024)]),_:1}),a(e(A),{name:"housing_room_id"},{default:s(({componentField:i})=>[a(e(E),null,{default:s(()=>[a(e(T),null,{default:s(()=>t[11]||(t[11]=[r("Habitación")])),_:1}),a(e(Pe),{open:j.value,"onUpdate:open":t[7]||(t[7]=o=>j.value=o)},{default:s(()=>[a(e(be),{"as-child":""},{default:s(()=>[a(e(N),null,{default:s(()=>[a(e(O),{type:"button",variant:"outline",role:"combobox",class:U(e(Y)("w-full sm:w-64 justify-between",!i.modelValue&&"text-muted-foreground"))},{default:s(()=>[r(y(C.value||"Selecciona la habitación...")+" ",1),a(e(ye),{class:"ml-2 h-4 w-4 shrink-0 opacity-50"})]),_:2},1032,["class"])]),_:2},1024)]),_:2},1024),a(e(we),{class:"w-[370px] sm:w-64 p-0"},{default:s(()=>[(f(),b(e(ue),{key:_.value,modelValue:C.value,"onUpdate:modelValue":t[6]||(t[6]=o=>C.value=o),class:"p-0"},{default:s(()=>[a(e(re),{class:"w-full px-4 py-2",placeholder:"Busca la habitación...",onInput:t[4]||(t[4]=o=>u.searchParam=o.target.value)}),C.value.length>0||u.searchParam.length>0?(f(),b(e(he),{key:0,class:"absolute right-5 top-3",size:20,onClick:t[5]||(t[5]=()=>{u.searchParam="",C.value="",_.value++})})):H("",!0),a(e(de),null,{default:s(()=>t[12]||(t[12]=[r("Sin resultados.")])),_:1}),a(e(me),null,{default:s(()=>[a(e(ce),null,{default:s(()=>[(f(!0),q(ne,null,fe(e(I).filter(o=>o.is_available||o.id==D.form.values.housing_room_id),o=>(f(),b(e(pe),{key:o.id,value:`${o.room_number} - ${o.housing}`,onSelect:()=>{m.form.setFieldValue("housing_room_id",o.id),C.value=`${o.room_number} - ${o.housing}`,j.value=!1}},{default:s(()=>[r(y(`${o.room_number} - ${o.housing}`)+" ",1),a(e(ve),{class:U(e(Y)("ml-auto h-4 w-4",m.form.values.housing_room_id==o.id?"opacity-100":"opacity-0"))},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"]))]),_:1})]),_:2},1032,["open"]),a(e(B))]),_:2},1024)]),_:1}),a(e(A),{name:"rental_start_date"},{default:s(({componentField:i})=>[a(e(E),null,{default:s(()=>[a(e(T),null,{default:s(()=>t[13]||(t[13]=[r("Fecha de ingreso")])),_:1}),a(e(N),null,{default:s(()=>[a(e(Z),G({type:"datetime-local"},i,{autocomplete:"off",class:"block"}),null,16)]),_:2},1024),a(e(B))]),_:2},1024)]),_:1}),a(e(A),{name:"rental_end_date"},{default:s(({componentField:i})=>[a(e(E),null,{default:s(()=>[a(e(T),null,{default:s(()=>t[14]||(t[14]=[r("Fecha de culminación")])),_:1}),a(e(N),null,{default:s(()=>[a(e(Z),G({type:"datetime-local"},i,{autocomplete:"off",class:"block"}),null,16)]),_:2},1024),a(e(B))]),_:2},1024)]),_:1}),a(e(A),{name:"payment"},{default:s(({componentField:i})=>[a(e(E),{class:U(!D.form.values.payment_date&&"col-span-full")},{default:s(()=>[a(e(T),null,{default:s(()=>t[15]||(t[15]=[r("Pago")])),_:1}),a(e(N),null,{default:s(()=>[a(e(Z),G({type:"number",step:"0.01"},i,{autocomplete:"off"}),null,16)]),_:2},1024),a(e(B))]),_:2},1032,["class"])]),_:1}),a(e(A),{name:"payment_date"},{default:s(({componentField:i})=>[a(e(E),{class:U(!D.form.values.payment_date&&"hidden")},{default:s(()=>[a(e(T),null,{default:s(()=>t[16]||(t[16]=[r("Fecha de pago")])),_:1}),a(e(N),null,{default:s(()=>[a(e(Z),G({type:"datetime-local"},i,{autocomplete:"off",class:"block"}),null,16)]),_:2},1024),a(e(B))]),_:2},1032,["class"])]),_:1}),a(e(A),{name:"description"},{default:s(({componentField:i})=>[a(e(E),{class:"col-span-2"},{default:s(()=>[a(e(T),null,{default:s(()=>t[17]||(t[17]=[r("Descripción (opcional)")])),_:1}),a(e(N),null,{default:s(()=>[a(e(Pa),G({placeholder:"Una descripción acerca del alquiler",rows:"5",class:"resize-none"},i),null,16)]),_:2},1024),a(e(B))]),_:2},1024)]),_:1})]),a(e(ta),null,{default:s(()=>[a(e(O),{type:"submit",class:"w-full mt-3 p-1",disabled:e(P)},{default:s(()=>[r(y(x.value?"Editar":"Agregar"),1)]),_:1},8,["disabled"])]),_:1})],32)]),_:1}))}}),mt=X({__name:"HousingPaymentContainer",setup(S){const v=Ee(),m={start:void 0,end:void 0},h=w(m),x=R(()=>window.innerWidth<768?{id:!1,tenancy_name:!1,payment:!1,description:!1,tenancy_document_number:!1}:{id:!1,tenancy_name:!0,payment:!0,description:!1,tenancy_document_number:!1}),l=le({page:1,limit:window.innerWidth<768?5:10,searchParam:v.query.customer||"",startDate:"",finishDate:"",paymentState:"all"}),{isFetching:P,data:p,meta:F}=it(L.housing_payment,l),d={id:void 0,housing_room_id:void 0,tenancy_id:void 0,payment:0,rental_start_date:"",rental_end_date:"",payment_date:"",description:""},n=ra(),k=da(),V=()=>{k.setValues(d)},W=t=>{k.setValues(t)},j=t=>{l.page=t.length>2?1:l.page,l.searchParam=t},C=t=>{l.page=t},_=t=>{l.page=1,l.limit=t},u=t=>{h.value=t};oe(h,t=>{if(!t||!t.start||!t.end){l.startDate="",l.finishDate="";return}l.startDate=ge(t.start),l.finishDate=ge(t.end,"end")}),oe(()=>v.query,t=>{l.searchParam=t.customer});const I=w(0),K=w(!1),Q=()=>{K.value=!1},D=[n.display({id:"select",header:({table:t})=>g(xe,{checked:t.getIsAllPageRowsSelected()||t.getIsSomePageRowsSelected()&&"indeterminate","onUpdate:checked":i=>t.toggleAllPageRowsSelected(!!i),ariaLabel:"Select all",class:"mr-2"}),cell:({row:t})=>g(xe,{checked:t.getIsSelected(),"onUpdate:checked":i=>t.toggleSelected(!!i),ariaLabel:"Select row"}),enableHiding:!1}),n.accessor("id",{header:"ID",cell:t=>g("span",t.getValue()??"")}),n.accessor("tenancy_name",{header:"Inquilino",cell:t=>g("div",{class:"capitalize min-w-20"},t.getValue())}),n.accessor("tenancy_document_number",{header:"N° de documento",cell:({row:t})=>{const i=t.getValue("tenancy_document_number"),o=t.original.tenancy_identity_document;return g("div",{class:"flex flex-col text-nowrap"},[o,g("span",{class:"font-bold text-slate-500"},i)])}}),n.accessor("housing_room",{header:"N° de habitación",cell:({row:t})=>{const i=t.getValue("housing_room"),o=t.original.housing;return g("div",{class:"flex flex-col text-nowrap"},[i,g("span",{class:"font-bold text-slate-500"},o)])}}),n.accessor("payment",{header:"Pago",cell:t=>g("div",t.getValue().toLocaleString(L.lang,{style:"currency",currency:"PEN"}))}),n.accessor("rental_start_date",{header:"Fecha de ingreso",cell:t=>{const i=te(t.getValue()),o=M(t.getValue());return g("div",{class:"min-w-28 flex flex-col"},[o,g("span",{class:"font-bold text-slate-500 text-sm"},i)])}}),n.accessor("rental_end_date",{header:"Fecha de culminación",cell:t=>{const i=te(t.getValue()),o=M(t.getValue());return g("div",{class:"min-w-28 flex flex-col"},[o,g("span",{class:"font-bold text-slate-500 text-sm"},i)])}}),n.accessor("payment_date",{header:"Fecha de pago",cell:t=>{if(t.getValue()){const i=te(t.getValue()),o=M(t.getValue());return g("div",{class:"min-w-36 flex flex-col"},[o,g("div",{class:"flex items-center gap-1"},[g(Se,{class:"text-green-500"}),g("span",{class:"font-bold text-green-500 text-sm"},i)])])}return g("div",{class:"flex items-center gap-1"},[g(Ce,{class:"text-blue-500"}),g("span",{class:"font-bold text-blue-500 text-sm"},"Pendiente")])}}),n.accessor("description",{header:"Descripción",cell:t=>g("div",{class:"max-w-60 truncate"},t.getValue())}),n.display({id:"actions",cell:({row:t})=>{const i=t.original;return g("div",{class:"relative"},g(ot,{housingPayment:i,"onUpdate:housingPaymentForm":W}))},enableHiding:!1})];return(t,i)=>(f(),b(e(ua),{open:K.value,"onUpdate:open":i[1]||(i[1]=o=>K.value=o)},{default:s(()=>[a(na,{icon:e(Te),title:"Gestión de alquileres",isFetching:e(P),"onReset:initialForm":V},null,8,["icon","isFetching"]),a(dt,{form:e(k),onReset:Q},null,8,["form"]),a(e(ba),{class:"flex flex-col sm:flex-row justify-center gap-y-2 mt-3 shadow-sm dark:bg-slate-900 py-2"},{default:s(()=>[a(e(wa),null,{default:s(()=>[a(e($a),{"as-child":""},{default:s(()=>[a(O,{variant:"outline",size:"lg",class:"dark:text-slate-200"},{default:s(()=>i[2]||(i[2]=[r("Fecha de alquiler")])),_:1})]),_:1}),a(e(ka),{"as-child":""},{default:s(()=>[a(Sa,{dates:h.value,"onUpdate:dates":u,"max-value":e(Ne)(e(Be)()).add({years:1})},null,8,["dates","max-value"])]),_:1})]),_:1}),a(e(Ue),{type:"single",class:"dark:text-slate-200","model-value":l.paymentState,"onUpdate:modelValue":i[0]||(i[0]=o=>l.paymentState=o)},{default:s(()=>[a(e(se),{value:"all","aria-label":"Toggle bold"},{default:s(()=>i[3]||(i[3]=[r(" Todos ")])),_:1}),a(e(se),{value:"rent_debtors"},{default:s(()=>i[4]||(i[4]=[r(" Pendientes ")])),_:1}),a(e(se),{value:"rent_payers"},{default:s(()=>i[5]||(i[5]=[r(" Cobrados ")])),_:1})]),_:1},8,["model-value"])]),_:1}),a(la,{render:!!h.value.start&&!!h.value.end||!!l.searchParam||!!l.paymentState&&l.paymentState!=="all",filters:[{render:!!l.searchParam,tag:"Búsqueda",name:l.searchParam,handleClick:()=>{I.value+=1,l.searchParam="",l.page=1}},{render:!!h.value.start&&!!h.value.end,tag:"Fechas",name:`Desde ${e(_e)(h.value.start)} hasta ${e(_e)(h.value.end)}`,handleClick:()=>{h.value=m,l.page=1}},{render:!!l.paymentState&&l.paymentState!=="all",tag:"Estado de pago",name:l.paymentState==="rent_debtors"?"Pendientes":l.paymentState==="rent_payers"?"Cancelados":"",handleClick:()=>{l.paymentState="all",l.page=1}}]},null,8,["render","filters"]),a(oa,{data:e(p),columns:D,"default-visible-columns":x.value,"delete-name":e(L).housing_payment,"delete-url":`${e($).housing_payment}/${e($).destroy_action}`,"title-dialog":"¿Estás seguro que quieres eliminar los alquileres seleccionados?","description-dialog":"Esta acción no se podrá deshacer. Esto eliminará los alquileres seleccionados permanentemente.","on-search-input":j,"input-render":I.value},null,8,["data","default-visible-columns","delete-name","delete-url","input-render"]),e(F)?(f(),b(ia,{key:0,meta:e(F),"on-change-page":C,"on-change-limit":_},null,8,["meta"])):H("",!0)]),_:1},8,["open"]))}}),Pt=X({__name:"HousingPaymentView",setup(S){return(v,m)=>(f(),b(mt))}});export{Pt as default};
