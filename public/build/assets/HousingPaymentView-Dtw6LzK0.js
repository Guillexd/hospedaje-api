import{c as J,d as A,h as k,o as _,i as x,w as t,k as a,m as c,u as e,l as d,t as P,Q as L,J as W,a as q,q as H,T as ae,B as Z,S as ie,v as He,n as M,e as $e,H as B,x as ze,y as Be,z as Ae,A as E,C as Ie,D as Ee,E as Te,F as ne,f as S,s as ke,G as je,I as Ne,a1 as Se,r as oe,K as Ce,L as De,a4 as Oe,p as R,b as G,a5 as Ue,a6 as Me,a7 as Re,N as le,X as qe,a8 as ue,a9 as re,aa as de,ab as me,ac as ce,W as fe,ad as pe,P as v,Y as te,ae as Le,af as We,ag as Ke,ah as Xe,ai as se,$ as _e,a0 as ge}from"./app-BDRffltI.js";import{E as Ge,_ as Je,S as Qe,s as Ye,t as Ze,u as ea,v as aa,w as ta,x as sa,y as na,z as la,a as oa,b as ia,c as ua,A as ye,X as he,d as ra,e as da,B as ve,f as Pe,g as ma,h as ca,i as fa,j as pa,k as _a,l as ga}from"./FilterBarPresentation.vue_vue_type_script_setup_true_lang-CaBDfNh3.js";import{e as K,_ as T,a as j,b as N,d as O,F as U,c as Y,u as ya}from"./Input.vue_vue_type_script_setup_true_lang-DeMhLLFw.js";import{_ as ha,a as va,b as Pa,c as ba,d as wa,e as xa}from"./DrawerTitle.vue_vue_type_script_setup_true_lang--CZw-r76.js";import{E as $a}from"./eye-SGDIUk-Z.js";import{P as ka,M as Sa}from"./phone-outgoing-BBkzLQ4Q.js";import{u as Ca,_ as Da,a as qa,b as Va,c as Fa,d as Ha,e as za}from"./Textarea.vue_vue_type_script_setup_true_lang-DRNEHBfm.js";import{u as Ba}from"./useFetchHousingRoom-DQZ_n5W9.js";/**
 * @license lucide-vue-next v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aa=J("BanIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-vue-next v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=J("CircleCheckBigIcon",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-vue-next v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ia=J("CircleSlashIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"9",x2:"15",y1:"15",y2:"9",key:"1dfufj"}]]);/**
 * @license lucide-vue-next v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=J("CircleXIcon",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-vue-next v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ea=J("FilePlus2Icon",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M3 15h6",key:"4e2qda"}],["path",{d:"M6 12v6",key:"1u72j0"}]]),Ta={class:"grid lg:grid-cols-[auto_1fr_auto] gap-3"},ja={class:"bg-white dark:bg-slate-300 shadow-lg rounded-lg p-4 max-w-xl w-full mx-auto lg:order-2"},Na={class:"flex justify-between"},Oa={class:"text-gray-700"},Ua={class:"flex justify-between"},Ma={class:"font-medium"},Ra={class:"text-gray-700"},La={class:"flex justify-between"},Wa={class:"text-gray-700"},Ka={class:"flex justify-between"},Xa={class:"font-medium"},Ga={class:"text-gray-700"},Ja={class:"text-gray-700 font-semibold"},Qa={class:"flex justify-between"},Ya={class:"text-gray-700 font-bold"},Za={class:"flex justify-between font-bold"},et={key:0,class:"flex items-center gap-1 text-green-700"},at={key:1,class:"flex items-center gap-1 text-blue-700"},tt={key:0,class:"text-black whitespace-pre-wrap font-medium mt-5 text-justify"},st={class:"mx-auto w-full sm:w-[50vw] lg:w-[25vw] lg:order-1"},nt=["src"],lt={key:1,class:"animate-pulse"},ot={class:"mx-auto w-full sm:w-[50vw] lg:w-[25vw] lg:order-3"},it=["src"],ut={key:1,class:"animate-pulse"},rt=["src"],dt=A({__name:"HousingPaymentDetail",props:{isDrawerOpen:{type:Boolean},housingPayment:{}},emits:["update:drawer-state"],setup(w,{emit:g}){const o=g;function $(i){o("update:drawer-state",i)}const l=window.innerWidth>1023&&window.innerWidth<1290?270:350,h=k(null),b=k("");function p(i,u){b.value=u,document.startViewTransition?document.startViewTransition(()=>{h.value=i}):h.value=i}function z(){document.startViewTransition?document.startViewTransition(()=>{h.value=null,b.value=""}):(h.value=null,b.value="")}return(i,u)=>(_(),x(e(xa),{open:i.isDrawerOpen,"onUpdate:open":u[2]||(u[2]=D=>$(D))},{default:t(()=>[a(e(wa),null,{default:t(()=>[c("div",{class:M(`p-4 overflow-y-auto ${h.value?"h-[97vh]":"max-h-[80vh] sm:max-h-[90vh]"}`)},[a(e(ha),{class:"max-w-lg mx-auto"},{default:t(()=>[a(e(va),{class:"text-xl font-semibold dark:text-slate-200"},{default:t(()=>u[3]||(u[3]=[d("Detalles del alquiler")])),_:1}),a(e(Pa),{class:"text-gray-500"},{default:t(()=>u[4]||(u[4]=[d(" Aquí puedes ver los detalles de este alquiler. ")])),_:1})]),_:1}),c("main",Ta,[c("section",ja,[u[10]||(u[10]=c("h3",{class:"text-lg font-bold"},"Información del alquiler",-1)),c("div",Na,[u[5]||(u[5]=c("span",{class:"font-medium"},"Nombre del inquilino:",-1)),c("span",Oa,P(i.housingPayment.tenancy_name),1)]),c("div",Ua,[c("span",Ma,P(i.housingPayment.tenancy_identity_document)+":",1),c("span",Ra,P(i.housingPayment.tenancy_document_number),1)]),c("div",La,[u[6]||(u[6]=c("span",{class:"font-medium"},"Teléfono:",-1)),c("span",Wa,P(i.housingPayment.tenancy_phone),1)]),c("div",Ka,[c("span",Xa,P(i.housingPayment.housing),1),c("span",Ga,"Habitación "+P(i.housingPayment.housing_room),1)]),c("div",Ja,[c("p",null,P(e(L)(i.housingPayment.rental_start_date))+" hasta "+P(e(L)(i.housingPayment.rental_end_date)),1)]),c("div",Qa,[u[7]||(u[7]=c("span",{class:"font-medium"},"Pago:",-1)),c("span",Ya,P(i.housingPayment.payment.toLocaleString(e(W).lang,{style:"currency",currency:"PEN"})),1)]),c("div",Za,[u[9]||(u[9]=c("span",{class:"font-medium"},"Estado:",-1)),i.housingPayment.payment_date?(_(),q("div",et,[a(e(Ve),{size:33}),d(" "+P(e(L)(i.housingPayment.payment_date)),1)])):H("",!0),i.housingPayment.payment_date?H("",!0):(_(),q("div",at,[a(e(Fe),{size:33}),u[8]||(u[8]=d(" Pendiente "))]))]),i.housingPayment.description?(_(),q("p",tt,P(i.housingPayment.description),1)):H("",!0)]),c("picture",st,[i.housingPayment.first_document_image_url?(_(),q("img",{key:0,src:i.housingPayment.first_document_image_url,alt:"documento",class:"rounded-lg mx-auto",style:ae({viewTransitionName:h.value?"":"img-1"}),onClick:u[0]||(u[0]=Z(D=>p(i.housingPayment.first_document_image_url,"img-1"),["stop"]))},null,12,nt)):(_(),q("section",lt,[a(e(ie),{class:"mx-auto text-slate-500",size:e(l)},null,8,["size"])]))]),c("picture",ot,[i.housingPayment.second_document_image_url?(_(),q("img",{key:0,src:i.housingPayment.second_document_image_url,alt:"documento",class:"rounded-lg mx-auto",style:ae({viewTransitionName:h.value?"":"img-2"}),onClick:u[1]||(u[1]=Z(D=>p(i.housingPayment.second_document_image_url,"img-2"),["stop"]))},null,12,it)):(_(),q("section",ut,[a(e(ie),{class:"mx-auto text-slate-500",size:e(l)},null,8,["size"])]))])]),a(e(ba),{class:"mt-4"},{default:t(()=>[a(e(He),{"as-child":""},{default:t(()=>[a(K,{variant:"outline",class:"max-w-lg w-full mx-auto dark:text-slate-200"},{default:t(()=>u[11]||(u[11]=[d(" Cerrar ")])),_:1})]),_:1})]),_:1})],2),h.value?(_(),q("picture",{key:0,class:"absolute top-0 left-0 w-screen h-screen flex items-center justify-center backdrop-blur-md z-50",onClick:Z(z,["stop"])},[c("img",{src:h.value,class:"max-h-[98vh] rounded-2xl mx-auto",alt:"documento",style:ae({viewTransitionName:b.value})},null,12,rt)])):H("",!0)]),_:1})]),_:1},8,["open"]))}});function mt(w){return $e(W.housing_payment,w)}const ct={class:"font-bold text-slate-300"},ft=A({__name:"DropdownHousingPaymentOptions",props:{housingPayment:{}},emits:["update:housing-payment-form"],setup(w,{emit:g}){const o=w,$=g;function l(){$("update:housing-payment-form",o.housingPayment)}const h=k(!1),b=k(!1),p=k(1),z=()=>{h.value=!0},i=y=>{h.value=y},u=y=>{b.value=!0,p.value=y},D=y=>{b.value=y},V=B(()=>({url:`${S.housing_payment}/${p.value===1?S.collect_and_payment:p.value===2?S.just_collect:S.cancel_collect}`,method:S.post})),{mutateAsync:X}=mt(V),I=B(()=>({id:o.housingPayment.id,housing_room_id:o.housingPayment.housing_room_id,tenancy_id:o.housingPayment.tenancy_id,payment:o.housingPayment.payment,rental_start_date:o.housingPayment.rental_start_date,rental_end_date:o.housingPayment.rental_end_date,description:o.housingPayment.description})),C=()=>ke(X(I.value),`${p.value===1?"Cobrando y agregando nuevo alquiler":p.value===2?"Cobrando":"Cancelando"}...`,()=>`Alquiler ${p.value===1?"cobrado y uno nuevo creado":p.value===2?"cobrado":"cancelado"} con éxito para ${o.housingPayment.tenancy_name}`,y=>typeof y=="object"?"Acción fallida":y);return(y,r)=>(_(),q(ne,null,[a(e(Te),null,{default:t(()=>[a(e(ze),{"as-child":""},{default:t(()=>[a(e(K),{variant:"ghost",class:"w-8 h-8 p-0"},{default:t(()=>[r[4]||(r[4]=c("span",{class:"sr-only"},"Abrir menu",-1)),a(e(Ge),{class:"w-4 h-4"})]),_:1})]),_:1}),a(e(Be),{align:"end"},{default:t(()=>[a(e(Ae),null,{default:t(()=>r[5]||(r[5]=[d("Opciones")])),_:1}),y.housingPayment.payment_date?H("",!0):(_(),x(e(E),{key:0,class:"flex items-center gap-x-2 text-amber-600 py-2 cursor-pointer",onClick:r[0]||(r[0]=F=>u(1))},{default:t(()=>[a(e(Ea),{class:"w-5 h-5"}),r[6]||(r[6]=d(" Cobrar y agregar alquiler "))]),_:1})),y.housingPayment.payment_date?H("",!0):(_(),x(e(E),{key:1,class:"flex items-center gap-x-2 text-amber-700 py-2 cursor-pointer",onClick:r[1]||(r[1]=F=>u(2))},{default:t(()=>[a(e(Ia),{class:"w-5 h-5"}),r[7]||(r[7]=d(" Solo cobrar "))]),_:1})),y.housingPayment.payment_date?(_(),x(e(E),{key:2,class:"flex items-center gap-x-2 text-rose-700 py-2 cursor-pointer",onClick:r[2]||(r[2]=F=>u(3))},{default:t(()=>[a(e(Aa),{class:"w-5 h-5"}),r[8]||(r[8]=d(" Cancelar cobro "))]),_:1})):H("",!0),a(e(E),{onClick:Z(z,["stop"]),class:"flex items-center gap-x-2 py-2 cursor-pointer"},{default:t(()=>[a(e($a),{class:"w-5 h-5"}),r[9]||(r[9]=d(" Ver "))]),_:1}),a(Je,{class:"w-full"},{default:t(()=>[a(e(E),{onClick:l,class:"flex items-center gap-x-2 text-sky-800 py-2 cursor-pointer"},{default:t(()=>[a(e(Qe),{class:"w-5 h-5"}),r[10]||(r[10]=d(" Editar "))]),_:1})]),_:1}),a(e(E),{as:"a",class:"flex items-center gap-x-2 text-red-700 py-2 cursor-pointer",href:e(Ie)(y.housingPayment.tenancy_phone)},{default:t(()=>[a(e(ka),{class:"w-5 h-5"}),r[11]||(r[11]=d(" Llamar "))]),_:1},8,["href"]),a(e(E),{as:"a",class:"flex items-center gap-x-2 text-green-800 py-2 cursor-pointer",href:e(Ee)(y.housingPayment.tenancy_phone,"?text=Buen%20día"),target:"_blank"},{default:t(()=>[a(e(Sa),{class:"w-5 h-5"}),r[12]||(r[12]=d(" Whatsapp "))]),_:1},8,["href"])]),_:1})]),_:1}),a(dt,{"is-drawer-open":h.value,"housing-payment":y.housingPayment,"onUpdate:drawerState":i},null,8,["is-drawer-open","housing-payment"]),a(e(la),{open:b.value,"onUpdate:open":r[3]||(r[3]=F=>D(F))},{default:t(()=>[a(e(Ye),null,{default:t(()=>[a(e(Ze),null,{default:t(()=>[a(e(ea),{class:"dark:text-slate-200"},{default:t(()=>[d(P(`¿Estás seguro que quieres ${p.value===1?"cobrar y agregar un nuevo alquiler":p.value===2?"solo cobrar el alquiler":"cancelar este cobro de alquiler"}`),1)]),_:1}),a(e(aa),null,{default:t(()=>[d(P(`Esta accion ${p.value===1?"cobrará y agregará un nuevo alquiler para":p.value===2?"solo cobrará el alquiler de":"cancelará este cobro de alquiler de"}`)+" ",1),c("span",ct,P(y.housingPayment.tenancy_name)+" - "+P(y.housingPayment.tenancy_identity_document)+": "+P(y.housingPayment.tenancy_document_number),1)]),_:1})]),_:1}),a(e(ta),null,{default:t(()=>[a(e(sa),{class:"dark:text-slate-200"},{default:t(()=>r[13]||(r[13]=[d("Cancelar")])),_:1}),a(e(na),{onClick:C},{default:t(()=>r[14]||(r[14]=[d("Sí, ¡seguro!")])),_:1})]),_:1})]),_:1})]),_:1},8,["open"])],64))}});function pt(w,g){const o=()=>Ne(`${S.housing_payment}/${S.list_action}?page=${g.page}&limit=${g.limit}&searchInput=${g.searchParam}&startDate=${g.startDate}&finishDate=${g.finishDate}${g.paymentState==="rent_debtors"?"&rent_debtors=1":g.paymentState==="rent_payers"?"&rent_payers=1":""}`),{data:$,...l}=je(w,o,g),h=B(()=>{var p;return((p=$.value)==null?void 0:p.data)??[]}),b=B(()=>{var p;return((p=$.value)==null?void 0:p.meta)??null});return{data:h,meta:b,...l}}const be=A({__name:"Popover",props:{defaultOpen:{type:Boolean},open:{type:Boolean},modal:{type:Boolean}},emits:["update:open"],setup(w,{emit:g}){const l=Se(w,g);return(h,b)=>(_(),x(e(Oe),Ce(De(e(l))),{default:t(()=>[oe(h.$slots,"default")]),_:3},16))}}),we=A({inheritAttrs:!1,__name:"PopoverContent",props:{forceMount:{type:Boolean},trapFocus:{type:Boolean},side:{},sideOffset:{default:4},align:{default:"center"},alignOffset:{},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},updatePositionStrategy:{},prioritizePosition:{type:Boolean},asChild:{type:Boolean},as:{},disableOutsidePointerEvents:{type:Boolean},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(w,{emit:g}){const o=w,$=g,l=B(()=>{const{class:b,...p}=o;return p}),h=Se(l,$);return(b,p)=>(_(),x(e(Me),null,{default:t(()=>[a(e(Ue),R({...e(h),...b.$attrs},{class:e(G)("z-50 w-72 rounded-md border border-slate-200 bg-white p-4 text-slate-950 shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 dark:border-slate-800 dark:bg-slate-950 dark:text-slate-50",o.class)}),{default:t(()=>[oe(b.$slots,"default")]),_:3},16,["class"])]),_:3}))}}),xe=A({__name:"PopoverTrigger",props:{asChild:{type:Boolean},as:{}},setup(w){const g=w;return(o,$)=>(_(),x(e(Re),Ce(De(g)),{default:t(()=>[oe(o.$slots,"default")]),_:3},16))}});function _t(w){return $e(W.housing_payment,w)}const gt={class:"flex flex-col sm:grid grid-cols-2 gap-x-2 gap-y-1 overflow-y-auto max-h-[71vh] p-1"},yt=A({__name:"HousingPaymentModal",props:{form:{}},emits:["reset"],setup(w,{emit:g}){const o=w,$=g,l=B(()=>!!o.form.values.id),h=B(()=>({url:`${S.housing_payment}/${l.value?S.update_action:S.store_action}`,method:l.value?S.put:S.post})),{isPending:b,mutateAsync:p}=_t(h),z=o.form.handleSubmit(n=>ke(p(n),`${l.value?"Editando":"Agregando"}...`,()=>(ee(),`Alquiler ${l.value?"actualizado":"agregado"} con éxito`),s=>typeof s=="object"?(o.form.setErrors(s),"Acción fallida"):s)),i=k(!1),u=k(""),D=k(1),V=le({page:1,limit:20,searchParam:"",startDate:"",finishDate:""}),{data:X}=Ca("",V),I=k(!1),C=k(""),y=k(1),r=le({page:1,limit:20,searchParam:"",active:1}),{data:F}=Ba("",r);function ee(){$("reset"),Q(!1)}function Q(n){n?(V.searchParam=o.form.values.tenancy_name,u.value=o.form.values.tenancy_name,r.searchParam=o.form.values.housing_room,C.value=`${o.form.values.housing_room} - ${o.form.values.housing}`):(V.searchParam="",u.value="",r.searchParam="",C.value="",D.value++,y.value++)}return qe(l,n=>{Q(n)}),(n,s)=>(_(),x(e(da),{class:"sm:max-w-[600px] text-slate-800 dark:dark:text-slate-200"},{default:t(()=>[a(e(ua),null,{default:t(()=>[a(e(oa),null,{default:t(()=>[d(P(l.value?"Editar":"Agregar")+" alquiler",1)]),_:1}),a(e(ia),null,{default:t(()=>[d(" Haz los cambios del alquiler aquí. Click "+P(l.value?"Editar":"Agregar")+" cuando termines. ",1)]),_:1})]),_:1}),c("form",{onSubmit:s[8]||(s[8]=(...f)=>e(z)&&e(z)(...f)),"keep-values":""},[c("section",gt,[a(e(U),{name:"tenancy_id"},{default:t(({componentField:f})=>[a(e(T),null,{default:t(()=>[a(e(j),null,{default:t(()=>s[9]||(s[9]=[d("Inquilino")])),_:1}),a(e(be),{open:i.value,"onUpdate:open":s[3]||(s[3]=m=>i.value=m)},{default:t(()=>[a(e(xe),{"as-child":""},{default:t(()=>[a(e(N),null,{default:t(()=>[a(e(K),{type:"button",variant:"outline",role:"combobox",class:M(e(G)("w-full sm:w-64 justify-between",!f.modelValue&&"text-muted-foreground"))},{default:t(()=>[d(P(u.value||"Selecciona al inquilino...")+" ",1),a(e(ye),{class:"ml-2 h-4 w-4 shrink-0 opacity-50"})]),_:2},1032,["class"])]),_:2},1024)]),_:2},1024),a(e(we),{class:"w-[370px] sm:w-64 p-0"},{default:t(()=>[(_(),x(e(ue),{key:D.value,modelValue:u.value,"onUpdate:modelValue":s[2]||(s[2]=m=>u.value=m),class:"p-0"},{default:t(()=>[a(e(re),{class:"w-full px-4 py-2",placeholder:"Busca al inquilino...",onInput:s[0]||(s[0]=m=>V.searchParam=m.target.value)}),u.value.length>0||V.searchParam.length>0?(_(),x(e(he),{key:0,class:"absolute right-5 top-3",size:20,onClick:s[1]||(s[1]=()=>{V.searchParam="",u.value="",D.value++})})):H("",!0),a(e(de),null,{default:t(()=>s[10]||(s[10]=[d("Sin resultados.")])),_:1}),a(e(me),null,{default:t(()=>[a(e(ce),null,{default:t(()=>[(_(!0),q(ne,null,fe(e(X),m=>(_(),x(e(pe),{key:m.id,value:m.name,onSelect:()=>{o.form.setFieldValue("tenancy_id",m.id),u.value=m.name,i.value=!1}},{default:t(()=>[d(P(m.name)+" ",1),a(e(ve),{class:M(e(G)("ml-auto h-4 w-4",o.form.values.tenancy_id==m.id?"opacity-100":"opacity-0"))},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"]))]),_:1})]),_:2},1032,["open"]),a(e(O))]),_:2},1024)]),_:1}),a(e(U),{name:"housing_room_id"},{default:t(({componentField:f})=>[a(e(T),null,{default:t(()=>[a(e(j),null,{default:t(()=>s[11]||(s[11]=[d("Habitación")])),_:1}),a(e(be),{open:I.value,"onUpdate:open":s[7]||(s[7]=m=>I.value=m)},{default:t(()=>[a(e(xe),{"as-child":""},{default:t(()=>[a(e(N),null,{default:t(()=>[a(e(K),{type:"button",variant:"outline",role:"combobox",class:M(e(G)("w-full sm:w-64 justify-between",!f.modelValue&&"text-muted-foreground"))},{default:t(()=>[d(P(C.value||"Selecciona la habitación...")+" ",1),a(e(ye),{class:"ml-2 h-4 w-4 shrink-0 opacity-50"})]),_:2},1032,["class"])]),_:2},1024)]),_:2},1024),a(e(we),{class:"w-[370px] sm:w-64 p-0"},{default:t(()=>[(_(),x(e(ue),{key:y.value,modelValue:C.value,"onUpdate:modelValue":s[6]||(s[6]=m=>C.value=m),class:"p-0"},{default:t(()=>[a(e(re),{class:"w-full px-4 py-2",placeholder:"Busca al inquilino...",onInput:s[4]||(s[4]=m=>r.searchParam=m.target.value)}),C.value.length>0||r.searchParam.length>0?(_(),x(e(he),{key:0,class:"absolute right-5 top-3",size:20,onClick:s[5]||(s[5]=()=>{r.searchParam="",C.value="",y.value++})})):H("",!0),a(e(de),null,{default:t(()=>s[12]||(s[12]=[d("Sin resultados.")])),_:1}),a(e(me),null,{default:t(()=>[a(e(ce),null,{default:t(()=>[(_(!0),q(ne,null,fe(e(F).filter(m=>m.is_available||m.id==n.form.values.housing_room_id),m=>(_(),x(e(pe),{key:m.id,value:`${m.room_number} - ${m.housing}`,onSelect:()=>{o.form.setFieldValue("housing_room_id",m.id),C.value=`${m.room_number} - ${m.housing}`,I.value=!1}},{default:t(()=>[d(P(`${m.room_number} - ${m.housing}`)+" ",1),a(e(ve),{class:M(e(G)("ml-auto h-4 w-4",o.form.values.housing_room_id==m.id?"opacity-100":"opacity-0"))},null,8,["class"])]),_:2},1032,["value","onSelect"]))),128))]),_:1})]),_:1})]),_:1},8,["modelValue"]))]),_:1})]),_:2},1032,["open"]),a(e(O))]),_:2},1024)]),_:1}),a(e(U),{name:"rental_start_date"},{default:t(({componentField:f})=>[a(e(T),null,{default:t(()=>[a(e(j),null,{default:t(()=>s[13]||(s[13]=[d("Fecha de ingreso")])),_:1}),a(e(N),null,{default:t(()=>[a(e(Y),R({type:"datetime-local"},f,{autocomplete:"off",class:"block"}),null,16)]),_:2},1024),a(e(O))]),_:2},1024)]),_:1}),a(e(U),{name:"rental_end_date"},{default:t(({componentField:f})=>[a(e(T),null,{default:t(()=>[a(e(j),null,{default:t(()=>s[14]||(s[14]=[d("Fecha de culminación")])),_:1}),a(e(N),null,{default:t(()=>[a(e(Y),R({type:"datetime-local"},f,{autocomplete:"off",class:"block"}),null,16)]),_:2},1024),a(e(O))]),_:2},1024)]),_:1}),a(e(U),{name:"payment"},{default:t(({componentField:f})=>[a(e(T),{class:M(!n.form.values.payment_date&&"col-span-full")},{default:t(()=>[a(e(j),null,{default:t(()=>s[15]||(s[15]=[d("Pago")])),_:1}),a(e(N),null,{default:t(()=>[a(e(Y),R({type:"number",step:"0.01"},f,{autocomplete:"off"}),null,16)]),_:2},1024),a(e(O))]),_:2},1032,["class"])]),_:1}),a(e(U),{name:"payment_date"},{default:t(({componentField:f})=>[a(e(T),{class:M(!n.form.values.payment_date&&"hidden")},{default:t(()=>[a(e(j),null,{default:t(()=>s[16]||(s[16]=[d("Fecha de pago")])),_:1}),a(e(N),null,{default:t(()=>[a(e(Y),R({type:"datetime-local"},f,{autocomplete:"off",class:"block"}),null,16)]),_:2},1024),a(e(O))]),_:2},1032,["class"])]),_:1}),a(e(U),{name:"description"},{default:t(({componentField:f})=>[a(e(T),{class:"col-span-2"},{default:t(()=>[a(e(j),null,{default:t(()=>s[17]||(s[17]=[d("Descripción (opcional)")])),_:1}),a(e(N),null,{default:t(()=>[a(e(Da),R({placeholder:"Una descripción acerca del alquiler",rows:"5",class:"resize-none"},f),null,16)]),_:2},1024),a(e(O))]),_:2},1024)]),_:1})]),a(e(ra),null,{default:t(()=>[a(e(K),{type:"submit",class:"w-full mt-3 p-1",disabled:e(b)},{default:t(()=>[d(P(l.value?"Editar":"Agregar"),1)]),_:1},8,["disabled"])]),_:1})],32)]),_:1}))}}),ht=A({__name:"HousingPaymentContainer",setup(w){const g={start:void 0,end:void 0},o=k(g),$=B(()=>window.innerWidth<768?{id:!1,tenancy_name:!1,payment:!1,description:!1,tenancy_document_number:!1}:{id:!1,tenancy_name:!0,payment:!0,description:!1,tenancy_document_number:!1}),l=le({page:1,limit:window.innerWidth<768?5:10,searchParam:"",startDate:"",finishDate:"",paymentState:"all"}),{isFetching:h,data:b,meta:p}=pt(W.housing_payment,l),z={id:void 0,housing_room_id:void 0,tenancy_id:void 0,payment:0,rental_start_date:"",rental_end_date:"",payment_date:"",description:""},i=ga(),u=ya(),D=()=>{u.setValues(z)},V=n=>{u.setValues(n)},X=n=>{l.page=n.length>2?1:l.page,l.searchParam=n},I=n=>{l.page=n},C=n=>{l.page=1,l.limit=n},y=n=>{o.value=n};qe(o,n=>{if(!n||!n.start||!n.end){l.startDate="",l.finishDate="";return}l.startDate=ge(n.start),l.finishDate=ge(n.end,"end")});const r=k(0),F=k(!1),ee=()=>{F.value=!1},Q=[i.display({id:"select",header:({table:n})=>v(Pe,{checked:n.getIsAllPageRowsSelected()||n.getIsSomePageRowsSelected()&&"indeterminate","onUpdate:checked":s=>n.toggleAllPageRowsSelected(!!s),ariaLabel:"Select all",class:"mr-2"}),cell:({row:n})=>v(Pe,{checked:n.getIsSelected(),"onUpdate:checked":s=>n.toggleSelected(!!s),ariaLabel:"Select row"}),enableHiding:!1}),i.accessor("id",{header:"ID",cell:n=>v("span",n.getValue()??"")}),i.accessor("tenancy_name",{header:"Inquilino",cell:n=>v("div",{class:"capitalize min-w-20"},n.getValue())}),i.accessor("tenancy_document_number",{header:"N° de documento",cell:({row:n})=>{const s=n.getValue("tenancy_document_number"),f=n.original.tenancy_identity_document;return v("div",{class:"flex flex-col text-nowrap"},[f,v("span",{class:"font-bold text-slate-500"},s)])}}),i.accessor("housing_room",{header:"N° de habitación",cell:({row:n})=>{const s=n.getValue("housing_room"),f=n.original.housing;return v("div",{class:"flex flex-col text-nowrap"},[s,v("span",{class:"font-bold text-slate-500"},f)])}}),i.accessor("payment",{header:"Pago",cell:n=>v("div",n.getValue().toLocaleString(W.lang,{style:"currency",currency:"PEN"}))}),i.accessor("rental_start_date",{header:"Fecha de ingreso",cell:n=>{const s=te(n.getValue()),f=L(n.getValue());return v("div",{class:"min-w-28 flex flex-col"},[f,v("span",{class:"font-bold text-slate-500 text-sm"},s)])}}),i.accessor("rental_end_date",{header:"Fecha de culminación",cell:n=>{const s=te(n.getValue()),f=L(n.getValue());return v("div",{class:"min-w-28 flex flex-col"},[f,v("span",{class:"font-bold text-slate-500 text-sm"},s)])}}),i.accessor("payment_date",{header:"Fecha de pago",cell:n=>{if(n.getValue()){const s=te(n.getValue()),f=L(n.getValue());return v("div",{class:"min-w-36 flex flex-col"},[f,v("div",{class:"flex items-center gap-1"},[v(Ve,{class:"text-green-500"}),v("span",{class:"font-bold text-green-500 text-sm"},s)])])}return v("div",{class:"flex items-center gap-1"},[v(Fe,{class:"text-blue-500"}),v("span",{class:"font-bold text-blue-500 text-sm"},"Pendiente")])}}),i.accessor("description",{header:"Descripción",cell:n=>v("div",{class:"max-w-60 truncate"},n.getValue())}),i.display({id:"actions",cell:({row:n})=>{const s=n.original;return v("div",{class:"relative"},v(ft,{housingPayment:s,"onUpdate:housingPaymentForm":V}))},enableHiding:!1})];return(n,s)=>(_(),x(e(_a),{open:F.value,"onUpdate:open":s[1]||(s[1]=f=>F.value=f)},{default:t(()=>[a(ma,{icon:e(Le),title:"Gestión de alquileres",isFetching:e(h),"onReset:initialForm":D},null,8,["icon","isFetching"]),a(yt,{form:e(u),onReset:ee},null,8,["form"]),a(e(za),{class:"flex flex-col sm:flex-row justify-center gap-y-2 mt-3 shadow-sm dark:bg-slate-900 h-28 sm:h-14"},{default:t(()=>[a(e(qa),null,{default:t(()=>[a(e(Va),{"as-child":""},{default:t(()=>[a(K,{variant:"outline",size:"lg",class:"dark:text-slate-200"},{default:t(()=>s[2]||(s[2]=[d("Fecha de alquiler")])),_:1})]),_:1}),a(e(Fa),{"as-child":""},{default:t(()=>[a(Ha,{dates:o.value,"onUpdate:dates":y,"max-value":e(We)(e(Ke)()).add({years:1})},null,8,["dates","max-value"])]),_:1})]),_:1}),a(e(Xe),{type:"single",class:"dark:text-slate-200","model-value":l.paymentState,"onUpdate:modelValue":s[0]||(s[0]=f=>l.paymentState=f)},{default:t(()=>[a(e(se),{value:"all","aria-label":"Toggle bold"},{default:t(()=>s[3]||(s[3]=[d(" Todos ")])),_:1}),a(e(se),{value:"rent_debtors"},{default:t(()=>s[4]||(s[4]=[d(" Pendientes ")])),_:1}),a(e(se),{value:"rent_payers"},{default:t(()=>s[5]||(s[5]=[d(" Cobrados ")])),_:1})]),_:1},8,["model-value"])]),_:1}),a(ca,{render:!!o.value.start&&!!o.value.end||!!l.searchParam||!!l.paymentState&&l.paymentState!=="all",filters:[{render:!!l.searchParam,tag:"Busqueda",name:l.searchParam,handleClick:()=>{r.value+=1,l.searchParam="",l.page=1}},{render:!!o.value.start&&!!o.value.end,tag:"Fechas",name:`De ${e(_e)(o.value.start)} hasta ${e(_e)(o.value.end)}`,handleClick:()=>{o.value=g,l.page=1}},{render:!!l.paymentState&&l.paymentState!=="all",tag:"Estado de pago",name:l.paymentState==="rent_debtors"?"Pendientes":l.paymentState==="rent_payers"?"Cancelados":"",handleClick:()=>{l.paymentState="all",l.page=1}}]},null,8,["render","filters"]),a(fa,{data:e(b),columns:Q,"default-visible-columns":$.value,"delete-name":e(W).housing_payment,"delete-url":`${e(S).housing_payment}/${e(S).destroy_action}`,"title-dialog":"¿Estás seguro que quieres eliminar los alquileres seleccionados?","description-dialog":"Esta acción no se podrá deshacer. Esto eliminará los alquileres seleccionados permanentemente.","on-search-input":X,"input-render":r.value},null,8,["data","default-visible-columns","delete-name","delete-url","input-render"]),e(p)?(_(),x(pa,{key:0,meta:e(p),"on-change-page":I,"on-change-limit":C},null,8,["meta"])):H("",!0)]),_:1},8,["open"]))}}),Ct=A({__name:"HousingPaymentView",setup(w){return(g,o)=>(_(),x(ht))}});export{Ct as default};
