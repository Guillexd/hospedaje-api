import{d as N,o as y,i as F,w as s,k as a,m as r,u as e,l as c,t as x,v as Q,h as H,a as Y,x as X,y as Z,z as ee,A as I,B as ae,C as se,D as te,E as le,F as ne,G as re,H as E,I as oe,f as b,e as ie,J as j,s as z,p as V,K as ue,L as de,q as R,M as ce,N as me,O as fe,P as v,Q as pe,U as _e}from"./app-BDRffltI.js";import{e as L,_ as D,a as k,b as P,c as U,d as S,F as C,u as ge}from"./Input.vue_vue_type_script_setup_true_lang-DeMhLLFw.js";import{E as he,_ as $e,S as ve,a as we,b as be,c as xe,d as ye,e as De,f as O,g as ke,h as Pe,i as Ue,j as Se,k as Ce,l as Fe}from"./FilterBarPresentation.vue_vue_type_script_setup_true_lang-CaBDfNh3.js";import{_ as Ve,a as Ee,b as Ne,c as Ae,d as Ie,e as je}from"./DrawerTitle.vue_vue_type_script_setup_true_lang--CZw-r76.js";import{E as Be}from"./eye-SGDIUk-Z.js";import{P as qe,M as He}from"./phone-outgoing-BBkzLQ4Q.js";import{t as Le,_ as Me}from"./tableNames-u1FCGaBB.js";import{S as Oe}from"./search-DuzZRMK0.js";const ze={class:"mx-auto w-full max-w-lg p-4"},Re={class:"mt-4 bg-white dark:bg-slate-300 shadow-lg rounded-lg p-4"},Te={class:"mb-4"},We={class:"flex justify-between"},Ge={class:"text-gray-700"},Ke={class:"flex justify-between"},Je={class:"text-gray-700"},Qe={class:"flex justify-between"},Ye={class:"text-gray-700"},Xe={class:"flex justify-between"},Ze={class:"text-gray-700"},ea={class:"flex justify-between"},aa={class:"text-gray-700"},sa=N({__name:"UserDetail",props:{isDrawerOpen:{type:Boolean},user:{}},emits:["update:drawer-state"],setup(h,{emit:f}){const n=f;function _(m){n("update:drawer-state",m)}return(m,t)=>(y(),F(e(je),{open:m.isDrawerOpen,"onUpdate:open":t[0]||(t[0]=w=>_(w))},{default:s(()=>[a(e(Ie),null,{default:s(()=>[r("div",ze,[a(e(Ve),null,{default:s(()=>[a(e(Ee),{class:"text-xl font-semibold dark:text-slate-200"},{default:s(()=>t[1]||(t[1]=[c("Detalles de usuario")])),_:1}),a(e(Ne),{class:"text-gray-500"},{default:s(()=>t[2]||(t[2]=[c(" Aquí puedes ver los detalles de este usuario. ")])),_:1})]),_:1}),r("div",Re,[r("div",Te,[t[8]||(t[8]=r("h3",{class:"text-lg font-bold"},"Información Personal",-1)),r("div",We,[t[3]||(t[3]=r("span",{class:"font-medium"},"Nombre:",-1)),r("span",Ge,x(m.user.name),1)]),r("div",Ke,[t[4]||(t[4]=r("span",{class:"font-medium"},"DNI:",-1)),r("span",Je,x(m.user.dni),1)]),r("div",Qe,[t[5]||(t[5]=r("span",{class:"font-medium"},"Teléfono:",-1)),r("span",Ye,x(m.user.phone),1)]),r("div",Xe,[t[6]||(t[6]=r("span",{class:"font-medium"},"Correo:",-1)),r("span",Ze,x(m.user.email),1)]),r("div",ea,[t[7]||(t[7]=r("span",{class:"font-medium"},"Fecha de Nacimiento:",-1)),r("span",aa,x(m.user.birth_date),1)])])]),a(e(Ae),{class:"mt-4"},{default:s(()=>[a(e(Q),{"as-child":""},{default:s(()=>[a(L,{variant:"outline",class:"w-full dark:text-slate-200"},{default:s(()=>t[9]||(t[9]=[c(" Cerrar ")])),_:1})]),_:1})]),_:1})])]),_:1})]),_:1},8,["open"]))}}),ta=N({__name:"DropdownUserOptions",props:{user:{}},emits:["update:user-form"],setup(h,{emit:f}){const n=h,_=f;function m(){_("update:user-form",n.user)}const t=H(!1),w=()=>{t.value=!0},i=g=>{t.value=g};return(g,u)=>(y(),Y(ne,null,[a(e(le),null,{default:s(()=>[a(e(X),{"as-child":""},{default:s(()=>[a(e(L),{variant:"ghost",class:"w-8 h-8 p-0"},{default:s(()=>[u[0]||(u[0]=r("span",{class:"sr-only"},"Abrir menu",-1)),a(e(he),{class:"w-4 h-4"})]),_:1})]),_:1}),a(e(Z),{align:"end"},{default:s(()=>[a(e(ee),null,{default:s(()=>u[1]||(u[1]=[c("Opciones")])),_:1}),a(e(I),{onClick:ae(w,["stop"]),class:"flex items-center gap-x-2 py-2 cursor-pointer"},{default:s(()=>[a(e(Be),{class:"w-5 h-5"}),u[2]||(u[2]=c(" Ver "))]),_:1}),a($e,{class:"w-full"},{default:s(()=>[a(e(I),{onClick:m,class:"flex items-center gap-x-2 text-sky-800 py-2 cursor-pointer"},{default:s(()=>[a(e(ve),{class:"w-5 h-5"}),u[3]||(u[3]=c(" Editar "))]),_:1})]),_:1}),a(e(I),{as:"a",class:"flex items-center gap-x-2 text-red-700 py-2 cursor-pointer",href:e(se)(g.user.phone)},{default:s(()=>[a(e(qe),{class:"w-5 h-5"}),u[4]||(u[4]=c(" Llamar "))]),_:1},8,["href"]),a(e(I),{as:"a",class:"flex items-center gap-x-2 text-green-800 py-2 cursor-pointer",href:e(te)(g.user.phone,"?text=Buen%20día"),target:"_blank"},{default:s(()=>[a(e(He),{class:"w-5 h-5"}),u[5]||(u[5]=c(" Whatsapp "))]),_:1},8,["href"])]),_:1})]),_:1}),a(sa,{"is-drawer-open":t.value,user:g.user,"onUpdate:drawerState":i},null,8,["is-drawer-open","user"])],64))}});function la(h,f){const n=()=>oe(`${b.users}/${b.list_action}?page=${f.page}&limit=${f.limit}&searchInput=${f.searchParam}&startDate=${f.startDate}&finishDate=${f.finishDate}`),{data:_,...m}=re(h,n,f),t=E(()=>{var i;return((i=_.value)==null?void 0:i.data)??[]}),w=E(()=>{var i;return((i=_.value)==null?void 0:i.meta)??null});return{data:t,meta:w,...m}}function na(h){return ie(j.users,h)}const ra={class:"flex flex-col sm:grid grid-cols-2 gap-x-2 gap-y-1 overflow-y-auto max-h-[71vh] p-1"},oa={class:"relative transition-all ease-in-out"},ia=N({__name:"UserModal",props:{form:{}},emits:["reset"],setup(h,{emit:f}){const n=h,_=f;function m(){_("reset")}const t=E(()=>!!n.form.values.id),w=E(()=>({url:`${b.users}/${t.value?b.update_action:b.store_action}`,method:t.value?b.put:b.post})),{isPending:i,mutateAsync:g}=na(w),u=n.form.handleSubmit($=>($.password_confirmation=$.password,z(g($),`${t.value?"Editando":"Agregando"}...`,()=>(m(),`Usuario ${t.value?"actualizado":"agregado"} con éxito`),o=>typeof o=="object"?(n.form.setErrors(o),"Acción fallida"):o))),B=()=>{ce(n.form.values.dni,$=>{n.form.setValues({name:$})},($,o,d)=>{n.form.setValues({name:`${$} ${o} ${d}`})})};return($,o)=>(y(),F(e(De),{class:"sm:max-w-[600px] text-slate-800 dark:dark:text-slate-200"},{default:s(()=>[a(e(xe),null,{default:s(()=>[a(e(we),null,{default:s(()=>[c(x(t.value?"Editar":"Agregar")+" usuario",1)]),_:1}),a(e(be),null,{default:s(()=>[c(" Haz los cambios del usuario aquí. Click "+x(t.value?"Editar":"Agregar")+" cuando termines. ",1)]),_:1})]),_:1}),r("form",{onSubmit:o[0]||(o[0]=(...d)=>e(u)&&e(u)(...d)),"keep-values":""},[r("section",ra,[a(e(C),{name:"name"},{default:s(({componentField:d})=>[a(e(D),null,{default:s(()=>[a(e(k),null,{default:s(()=>o[1]||(o[1]=[c("Nombre")])),_:1}),a(e(P),null,{default:s(()=>[a(e(U),V(d,{autocomplete:"off"}),null,16)]),_:2},1024),a(e(S))]),_:2},1024)]),_:1}),a(e(C),{name:"dni"},{default:s(({componentField:d})=>[a(e(D),null,{default:s(()=>[a(e(k),null,{default:s(()=>o[2]||(o[2]=[c("DNI")])),_:1}),a(e(P),null,{default:s(()=>[r("div",oa,[a(e(Oe),{class:"absolute left-1 bottom-1 hover:scale-110 cursor-pointer text-green-500",size:30,onClick:B}),a(e(U),V({type:"number",class:"pl-11"},d,{autocomplete:"off",max:"999999999"}),null,16)])]),_:2},1024),a(e(S))]),_:2},1024)]),_:1}),a(e(C),{name:"phone"},{default:s(({componentField:d})=>[a(e(D),null,{default:s(()=>[a(e(k),null,{default:s(()=>o[3]||(o[3]=[c("Celular")])),_:1}),a(e(P),null,{default:s(()=>[a(e(U),V({type:"number"},d,{autocomplete:"off",max:"999999999"}),null,16)]),_:2},1024),a(e(S))]),_:2},1024)]),_:1}),a(e(C),{name:"birth_date"},{default:s(({componentField:d})=>[a(e(D),null,{default:s(()=>[a(e(k),null,{default:s(()=>o[4]||(o[4]=[c("Fecha de nacimiento")])),_:1}),a(e(P),null,{default:s(()=>[a(e(U),V({type:"date"},d,{class:"block"}),null,16)]),_:2},1024),a(e(S))]),_:2},1024)]),_:1}),a(e(C),{name:"email"},{default:s(({componentField:d})=>[a(e(D),null,{default:s(()=>[a(e(k),null,{default:s(()=>o[5]||(o[5]=[c("Correo electrónico")])),_:1}),a(e(P),null,{default:s(()=>[a(e(U),V(d,{autocomplete:"off"}),null,16)]),_:2},1024),a(e(S))]),_:2},1024)]),_:1}),t.value?R("",!0):(y(),F(e(C),{key:0,name:"password"},{default:s(({componentField:d})=>[a(e(D),null,{default:s(()=>[a(e(k),null,{default:s(()=>o[6]||(o[6]=[c("Contraseña")])),_:1}),a(e(P),null,{default:s(()=>[a(e(U),ue(de(d)),null,16)]),_:2},1024),a(e(S))]),_:2},1024)]),_:1}))]),a(e(ye),null,{default:s(()=>[a(e(L),{type:"submit",class:"w-full mt-3 p-1",disabled:e(i)},{default:s(()=>[c(x(t.value?"Editar":"Agregar"),1)]),_:1},8,["disabled"])]),_:1})],32)]),_:1}))}}),ua=N({__name:"UserContainer",setup(h){const f=E(()=>window.innerWidth<768?{id:!1,email:!1,birth_date:!1}:{id:!1,email:!0,birth_date:!0}),n=me({page:1,limit:window.innerWidth<768?5:10,searchParam:"",startDate:"",finishDate:""}),{isFetching:_,data:m,meta:t}=la(j.users,n),w={id:void 0,name:"",email:"",password:`$HSL-${new Date().getFullYear()}$`,dni:"",phone:"",birth_date:""},i=Fe(),g=ge(),u=()=>{g.setValues(w)},B=l=>{g.setValues(l)},$=l=>{n.page=l.length>2?1:n.page,n.searchParam=l},o=l=>{n.page=l},d=l=>{n.page=1,n.limit=l},M=H(0),q=H(!1),T=()=>{q.value=!1},{isPending:W,mutateAsync:G}=fe(j.users,Le.user),K=(l,p)=>z(G({id:l,state:p}),`${p?"Activando":"Desactivando"}...`,()=>`Propiedad ${p?"activada":"desactivada"} con éxito`,A=>typeof A=="object"?"Acción fallida":A),J=[i.display({id:"select",header:({table:l})=>v(O,{checked:l.getIsAllPageRowsSelected()||l.getIsSomePageRowsSelected()&&"indeterminate","onUpdate:checked":p=>l.toggleAllPageRowsSelected(!!p),ariaLabel:"Select all",class:"mr-2 md:mr-0"}),cell:({row:l})=>v(O,{checked:l.getIsSelected(),"onUpdate:checked":p=>l.toggleSelected(!!p),ariaLabel:"Select row"}),enableHiding:!1}),i.accessor("id",{header:"ID",cell:l=>v("span",l.getValue())}),i.accessor("name",{header:"Nombre",cell:l=>v("span",{class:"capitalize min-w-28"},l.getValue())}),i.accessor("email",{header:"Correo electrónico",cell:l=>v("span",l.getValue())}),i.accessor("dni",{header:"DNI",cell:l=>v("span",l.getValue())}),i.accessor("birth_date",{header:"Fecha de nacimiento",cell:l=>v("div",{class:"min-w-28"},pe(l.getValue(),"start"))}),i.accessor("is_active",{header:"Estado",cell:({row:l})=>v(Me,{checked:!!l.getValue("is_active"),"onUpdate:checked":()=>K(l.getValue("id"),!l.getValue("is_active")),disabled:W.value||_.value})}),i.display({id:"actions",cell:({row:l})=>{const p=l.original;return v("div",{class:"relative"},v(ta,{user:p,"onUpdate:userForm":B}))},enableHiding:!1})];return(l,p)=>(y(),F(e(Ce),{open:q.value,"onUpdate:open":p[0]||(p[0]=A=>q.value=A)},{default:s(()=>[a(ke,{icon:e(_e),title:"Gestión de usuarios",isFetching:e(_),"onReset:initialForm":u},null,8,["icon","isFetching"]),a(ia,{form:e(g),onReset:T},null,8,["form"]),a(Pe,{render:!!n.searchParam,filters:[{render:!!n.searchParam,tag:"Busqueda",name:n.searchParam,handleClick:()=>{M.value+=1,n.searchParam="",n.page=1}}]},null,8,["render","filters"]),a(Ue,{data:e(m),columns:J,"default-visible-columns":f.value,"delete-name":e(j).users,"delete-url":`${e(b).users}/${e(b).destroy_action}`,"title-dialog":"¿Estás seguro que quieres eliminar a los usuarios seleccionados?","description-dialog":"Esta acción no se podrá deshacer. Esto eliminará a los usuarios seleccionados permanentemente.","on-search-input":$,"input-render":M.value},null,8,["data","default-visible-columns","delete-name","delete-url","input-render"]),e(t)?(y(),F(Se,{key:0,meta:e(t),"on-change-page":o,"on-change-limit":d},null,8,["meta"])):R("",!0)]),_:1},8,["open"]))}}),$a=N({__name:"UsersView",setup(h){return(f,n)=>(y(),F(ua))}});export{$a as default};
